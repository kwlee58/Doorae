{
    "contents" : "---\ntitle: \"Doorae\"\nauthor: \"coop711\"\ndate: \"2015년 8월 23일\"\noutput: html_document\n---\n\n관광두레 주민공동체 현황분석\n----------------------------\n\n* 자료 구조 확인\n\n```{r echo=FALSE}\ngetwd()\nload(\"doorae_0823.rda\")\nlibrary(xtable)\nlibrary(stargazer)\nlibrary(knitr)\nlibrary(tables)\nlibrary(pander)\noptions(xtable.comment=FALSE)\noptions(family=\"AppleGothic\")\nls()\n```\n\n```{r, echo=FALSE}\nstr.doorae <- str(doorae)\ncols.no.summary <- c(cols.no.summary, 60)\nstr.doorae\n```\n\n* 기초통계 및 요약 파악\n\n```{r echo=FALSE}\noptions(width=132)\noptions(digits=2)\ndoorae.summary<-sapply(doorae[,-cols.no.summary], summary)\npander(doorae.summary)\n```\n\n\n* \"공동체상태\" 등을 기초로 2-way 교차분석\n\n1. 공동체상태와 조직형태\n\n1.1 교차표\n\n```{r echo=FALSE, results='asis'}\n# status.vs.structure<-table(doorae$\"공동체상태\", doorae$\"조직형태\", dnn=c(\"공동체상태\", \"조직형태\"))\n# print(xtable(status.vs.structure), type=\"html\", html.table.attributes=\"border=0\")\n# print(xtable(addmargins(status.vs.structure), digits=0), type=\"html\", html.table.attributes=\"border=0\")\n# print(xtable(prop.table(status.vs.structure, margin=1)*100, digits=1), type=\"html\", html.table.attributes=\"border=0\")\n```\n\n```{r, echo=FALSE}\nstatus.vs.structure<-table(doorae$\"공동체상태\", doorae$\"조직형태\", dnn=c(\"공동체상태\", \"조직형태\"))\nstatus.vs.structure.am <- addmargins(status.vs.structure)\ndimnames(status.vs.structure.am)[[1]][3] <- \"계\"\ndimnames(status.vs.structure.am)[[2]][3] <- \"계\"\nstatus.vs.structure.am\n```\n\n```{r, echo=FALSE, results='asis'}\npander(status.vs.structure, caption=\"공동체상태와 조직형태\")\npander(status.vs.structure.am, digits=0, caption=\"공동체상태와 조직형태(계)\")\npander(prop.table(status.vs.structure, margin=1)*100, digits=1, caption=\"공동체상태와 조직형태(%)\")\n```\n\n1.2 모자이크 플롯 \n\n```{r fig.width=6, fig.height=6}\nmosaicplot(status.vs.structure, color=rainbow(2), main=\"공동체상태와 조직형태\")\ntext(coord.text, labels=t(status.vs.structure))\n```\n\n생각을 잠시 바꿔보면\n\n```{r fig.width=6, fig.height=6}\nmosaicplot(t(status.vs.structure), color=rainbow(2), main=\"조직형태와 공동체상태\")\ntext(coord.text.1.2, labels=status.vs.structure)\n```\n\n\n1.3 성장단계 구분에의 시사점\n\n```{r, results='asis', echo=FALSE}\nknitr::kable(doorae[corporate.bi, c(\"공동체상태\", \"조직명\", \"성과_사업착수\", \"성과_사업자등록\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")])\nknitr::kable(doorae[noncorporate.bi, c(\"공동체상태\", \"조직명\", \"성과_사업착수\", \"성과_사업자등록\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")])\nknitr::kable(doorae[corporate.bp, c(\"공동체상태\", \"조직명\", \"성과_사업착수\", \"성과_사업자등록\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")])\nknitr::kable(doorae[noncorporate.bp, c(\"공동체상태\", \"조직명\", \"성과_사업착수\", \"성과_사업자등록\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")])\n```\n\n```{r, echo=FALSE, results='asis'}\nstargazer(format(ftable(table(doorae$\"공동체상태\", doorae$\"조직형태\", \"사업자등록 여부\"=doorae$\"성과_사업자등록\")), quote=FALSE, justify=\"right\"), type=\"html\", title=\"공동체상태/조직형태와 사업자등록여부\")\n```\n\n```{r, echo=FALSE, results='asis'}\nstargazer(format(prop.table(ftable(table(doorae$\"공동체상태\", doorae$\"조직형태\", \"사업자등록 여부\"=doorae$\"성과_사업자등록\")), margin=1)*100, quote=FALSE, justify=\"right\"), type=\"html\", title=\"공동체상태/조직형태와 사업자등록여부(%)\")\n```\n\n```{r, echo=FALSE, results='asis'}\nstargazer(format(ftable(table(doorae$\"공동체상태\", doorae$\"조직형태\", \"사업착수 여부\"=doorae$\"성과_사업착수\")), quote=FALSE, justify=\"right\"), type=\"html\", title=\"공동체상태/조직형태와 사업착수여부\")\n```\n\n```{r, echo=FALSE, results='asis'}\nstargazer(format(prop.table(ftable(table(doorae$\"공동체상태\", doorae$\"조직형태\", \"사업착수 여부\"=doorae$\"성과_사업착수\")), margin=1)*100, quote=FALSE, justify=\"right\"), type=\"html\", digits=4, title=\"공동체상태/조직형태와 사업착수여부(%)\")\n```\n\n------------------------\n\n2. 공동체상태와 법인유형\n\n2.1 교차표\n\n```{r, results='asis', echo=FALSE}\nstatus.vs.corporate_type<-table(doorae$\"공동체상태\", doorae$\"법인유형\", dnn=c(\"공동체상태\", \"조직유형\"))\nknitr::kable(status.vs.corporate_type, caption=\"ㅇ공동체상태와 조직유형\")\n````\n---------------\n\n```{r, results='asis', echo=FALSE}\nknitr::kable(doorae[stock.co, c(\"공동체상태\", \"조직명\")], caption=\"ㅇ주식회사인 공동체사업체\")\n```\n\n2.2 모자이크 플롯\n\n```{r fig.width=6, fig.height=6}\nmosaicplot(status.vs.corporate_type, color=rainbow(7), main=\"공동체상태와 조직유형\", las=1)\ntext(coord.text.2, labels=t(status.vs.corporate_type))\n```\n\n\n3. 공동체상태와 사업아이템\n\n3.1 교차표 \n\n```{r, results='asis', echo=FALSE}\nstatus.vs.business_item<-table(doorae$\"공동체상태\", doorae$\"사업아이템\", dnn=c(\"공동체상태\", \"사업아이템\"))\nknitr::kable(status.vs.business_item)\n```\n\n\n3.2 모자이크 플롯\n\n```{r fig.width=6, fig.height=6}\nmosaicplot(status.vs.business_item, color=rainbow(7), main=\"공동체상태와 사업아이템\", las=1)\ntext(coord.text.3, labels=t(status.vs.business_item))\n```\n\n\n4. 공동체상태와 업력\n\n4.1 요약표\n\n```{r, results='asis'}\npander(tapply(doorae$\"업력\", doorae$\"공동체상태\", summary))\n```\n\n4.2 Box Plot\n\n```{r echo=FALSE, fig.width=6, fig.height=5}\nplot(x=doorae$\"공동체상태\", y=doorae$\"업력\", main=\"공동체상태와 업력\")\ntext(coord.text.4, labels=doorae$\"조직명\"[c(21, 63)])\n```\n\n4.3 ECDF\n\n```{r echo=FALSE, fig.width=7, fig.height=5}\nlibrary(ggplot2)\necdf.2<-ggplot(doorae.ys, aes(x=years, colour=status)) + stat_ecdf()\necdf.2<-ecdf.2 + theme_bw()\necdf.2<-ecdf.2 + theme(panel.background=element_rect(\"white\"), panel.border=element_rect(colour=\"black\", fill=NA))\necdf.2<-ecdf.2 + ggtitle(\"공동체상태와 업력\") + theme(text=element_text(family=\"Apple SD Gothic Neo\"))\necdf.2<-ecdf.2 + xlab(\"업력\") + theme(axis.title.x=element_text(family=\"Apple SD Gothic Neo\"))\necdf.2<-ecdf.2 + ylab(\"분위\") + theme(axis.title.y=element_text(family=\"Apple SD Gothic Neo\"))\necdf.2<-ecdf.2 + labs(colour=\"공동체상태\") + theme(legend.title=element_text(family=\"Apple SD Gothic Neo\"))\necdf.2<-ecdf.2 + scale_colour_discrete(labels=c(\"창업준비\", \"경영개선\")) + theme(legend.text=element_text(family=\"Apple SD Gothic Neo\"))\necdf.2\n```\n\n4.4 Dot Chart\n\n```{r echo=FALSE, fig.width=6, fig.height=9.6}\nggplot(doorae, aes(x=업력, y=name)) + geom_segment(aes(yend=name), xend=0, colour=\"grey50\") +\ngeom_point(size=3, aes(colour=공동체상태)) +\nscale_colour_brewer(palette=\"Set1\", limits=c(\"경영개선\", \"창업준비\")) +\ntheme_bw() +\ntheme(axis.title.x=element_text(family=\"Apple SD Gothic Neo\")) +\nylab(\"조직명\") + theme(axis.title.y=element_text(family=\"Apple SD Gothic Neo\")) +\ntheme(axis.text.y=element_text(family=\"Apple SD Gothic Neo\", size=6)) +\ntheme(panel.grid.major.y=element_blank(), legend.position=c(1, 0.55), \nlegend.justification=c(1, 0.5),\nlegend.title=element_text(family=\"Apple SD Gothic Neo\"),\nlegend.text=element_text(family=\"Apple SD Gothic Neo\"))\n```\n\n\n5. 방문객과 매출\n\n5.1 공동체 상태 별 평균과 중위값 비교\n\n```{r echo=FALSE}\nknitr::kable(aggregate(doorae[c(\"성과_방문객_2014\", \"성과_방문객_2015_3개월\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")], list(\"공동체상태\"=doorae$\"공동체상태\"), mean))\nknitr::kable(aggregate(doorae[c(\"성과_방문객_2014\", \"성과_방문객_2015_3개월\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")], list(\"공동체상태\"=doorae$\"공동체상태\"), median))\n```\n\n\n5.2 2014, 2015년도 방문객 및 매출 순 조직명 파악\n\n```{r, results='asis', echo=FALSE}\nknitr::kable(doorae[order(doorae$\"성과_방문객_2014\", decreasing=TRUE), c(\"공동체상태\", \"조직명\", \"성과_방문객_2014\")][1:20,])\nknitr::kable(doorae[order(doorae$\"성과_방문객_2015_3개월\", decreasing=TRUE), c(\"공동체상태\", \"조직명\", \"성과_방문객_2015_3개월\")][1:20,])\nknitr::kable(doorae[order(doorae$\"성과_매출_2014\", decreasing=TRUE), c(\"공동체상태\", \"조직명\", \"성과_매출_2014\")][1:20,])\nknitr::kable(doorae[order(doorae$\"성과_매출_2015_3개월\", decreasing=TRUE), c(\"공동체상태\", \"조직명\", \"성과_매출_2015_3개월\")][1:20,])\n```\n\n",
    "created" : 1443237773983.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2412727644",
    "id" : "F847D3B7",
    "lastKnownWriteTime" : 1443423519,
    "path" : "~/data/Doorae0824.Rmd",
    "project_path" : "Doorae0824.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}